name: ğŸš€ Release Docker Publisher

on:
  release:
    types: [published]
  workflow_dispatch:

run-name: ğŸš€ Publish Release ${{ github.event.release.tag_name }}

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  call-reusable-build:
    name: Build and Push Release Image
    # ä½¿ç”¨å¯å¤ç”¨å·¥ä½œæµ
    uses: ./.github/workflows/reusable-build.yml
    with:
      # ç”Ÿæˆé•œåƒæ ‡ç­¾ï¼šä¸€ä¸ªåŸºäº release tagï¼Œä¸€ä¸ªæ ‡è®°ä¸º latest
      tags: |
        ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.event.release.tag_name }}
        ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:latest
      push: true
    secrets:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}